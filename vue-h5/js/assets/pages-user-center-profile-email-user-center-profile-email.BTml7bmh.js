import{R as e,T as a,V as t,U as i,x as o,D as l,H as r,Y as s,z as n,F as m,B as u,C as c,Z as d,I as p,J as f,v as g,W as b,ax as _,X as x,aV as v}from"./index-Sr5TDQAh.js";import{_ as w}from"./uni-nav-bar.By4fAi85.js";import{r as j}from"./uni-app.es.B63rG-5C.js";import{_ as h}from"./u-input.C3EplMLn.js";import{_ as y,a as C}from"./u-form.CW5ng56b.js";import{_ as k}from"./u-button.CU7Qcvp2.js";import{_ as V}from"./u-code.DYx93_fG.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.Dfj_jVd_.js";import"./uni-status-bar.vrssoW7T.js";import"./u-icon.CLEL_UCr.js";import"./u-line.CzSBNpvZ.js";import"./u-loading-icon.BJj1gzKk.js";const $=F(Object.assign({name:"user-center-profile-email"},{__name:"user-center-profile-email",setup(F){const{t:$}=e(),q=a(),R=t(),U=i({email:q.userinfo.email,code:""}),B=t(),I=t(),J=t(50),L={email:[{type:"string",required:!0,message:$("mail.text.tip1"),trigger:["blur"]},{validator:(e,a)=>uni.$u.test.email(a),message:$("mail.text.tip2"),trigger:["blur","change"]}],code:{type:"string",required:!0,message:$("mail.text.tip3"),trigger:["blur"]}};function Z(){R.value.validateField("email",(async e=>{if(e.length)return void(await g({title:e[0].message,icon:"none"}));if(!B.value.canGetCode)return void(await g({title:$("mail.text.tip4"),icon:"none"}));await b({title:$("mail.text.tip5")});const{error:a,message:t}=await _({email:U.email,captcha:"spew"});a?await g({title:t,icon:"none"}):(x(),a?await g({title:t,icon:"none"}):(await g({title:$("mail.text.tip6"),icon:"none"}),B.value.start()))}))}async function z(){try{await R.value.validate();const{error:e,message:a}=await v(U);await g({title:a,icon:"none",duration:1e3}),e||(await q.refreshUserinfo(),d())}catch(e){e.length&&await g({title:e[0].message,icon:"none"})}}return(e,a)=>{const t=j(o("uni-nav-bar"),w),i=j(o("up-input"),h),g=j(o("up-form-item"),y),b=u,_=j(o("up-form"),C),x=j(o("up-button"),k),v=j(o("up-code"),V);return c(),l(m,null,[r(t,{title:e.$t("page.title.mail"),"status-bar":"","left-icon":"left","background-color":"#F8F8F8",fixed:"",border:!1,onClickLeft:s(d)},null,8,["title","onClickLeft"]),r(b,{class:"body"},{default:n((()=>[r(_,{class:"form","label-width":"120",labelPosition:"top",model:U,rules:L,ref_key:"formRef",ref:R},{default:n((()=>[r(g,{required:"","left-icon":"email",label:e.$t("mail.text.yourMailbox"),prop:"email",borderBottom:"",ref:"item1"},{default:n((()=>[r(i,{modelValue:U.email,"onUpdate:modelValue":a[0]||(a[0]=e=>U.email=e),placeholder:L.email[0].message},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(g,{required:"","left-icon":"lock",label:e.$t("common.text.verificationCode"),prop:"code",borderBottom:"",ref:"item1"},{default:n((()=>[r(i,{type:"password",modelValue:U.code,"onUpdate:modelValue":a[1]||(a[1]=e=>U.code=e),placeholder:L.code.message},{suffix:n((()=>[r(b,{class:"font-12-blue",onClick:Z},{default:n((()=>[p(f(I.value),1)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"]),r(x,{class:"mt-100",color:"rgb(255, 69, 0)",text:e.$t("common.text.submit"),onClick:z},null,8,["text"]),r(v,{seconds:J.value,ref_key:"emailCodeRef",ref:B,onChange:a[2]||(a[2]=e=>I.value=e)},null,8,["seconds"])])),_:1})],64)}}}),[["__scopeId","data-v-6919b057"]]);export{$ as default};
