import{R as e,aC as t,V as a,U as n,x as l,y as r,z as o,v as s,B as i,C as u,H as m,Y as c,Z as p,b_ as f,I as d,J as y,bX as _,c6 as x,c7 as g,N as b}from"./index-Sr5TDQAh.js";import{_ as v}from"./uni-nav-bar.By4fAi85.js";import{r as P}from"./uni-app.es.B63rG-5C.js";import{_ as h}from"./uni-section.yeJKfGdi.js";import{_ as w}from"./u-input.C3EplMLn.js";import{_ as j,a as $}from"./u-form.CW5ng56b.js";import{_ as C}from"./u-icon.CLEL_UCr.js";import{_ as T}from"./u-button.CU7Qcvp2.js";import{c as k,r as V}from"./wallet.B9er1vRS.js";import{_ as q}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.Dfj_jVd_.js";import"./uni-status-bar.vrssoW7T.js";import"./u-line.CzSBNpvZ.js";import"./u-loading-icon.BJj1gzKk.js";const R=q({__name:"user-center-recharge-scan-payment",props:{type:String,naviBarTitle:String},setup(q){const{t:R}=e(),U=q,E=t((()=>({navbarTitle:"wechatpay"===U.type?R("onlinePayment.text.wechatPay"):R("onlinePayment.text.aliPay"),contentTitle:"wechatpay"===U.type?R("onlinePayment.text.wechatPayTip"):R("onlinePayment.text.aliPayTip")}))),F=a(),I=n({money:"",transfer_username:""}),A={money:{type:"string",required:!0,message:R("onlinePayment.text.transferAmountErrorTip"),trigger:["blur","change"]},transfer_username:{type:"string",required:!0,message:R("onlinePayment.text.transferUserErrorTip"),trigger:["blur","change"]}},B=a({});async function H(){if(console.log("触发了",I.money),B.value.max_money<parseFloat(I.money))s({title:"充值金额已超过最大可充值金额"+B.value.max_money+"，请重新输入",icon:"none"});else try{await F.value.validate(),x({title:R("common.text.systemHint"),content:R("onlinePayment.text.tip1"),success:async e=>{if(e.confirm){const{error:e,message:t,data:a}=await V({type:B.value.type,payment_id:B.value.id,transfer:"transfer",money:I.money,transfer_username:I.transfer_username});if(e)return void(await s({title:t,icon:"none"}));g({id:a.id})}}})}catch(e){e.length&&await s({title:e[0].message,icon:"none"})}}return async function(){const{error:e,message:t,data:a}=await k({type:U.type});e?await s({title:t,icon:"none"}):(B.value=a.list,console.log("data",a))}(),(e,t)=>{const a=P(l("uni-nav-bar"),v),n=b,s=i,x=P(l("uni-section"),h),g=P(l("up-input"),w),k=P(l("up-form-item"),j),V=P(l("up-icon"),C),q=P(l("up-form"),$),R=P(l("up-button"),T);return u(),r(s,null,{default:o((()=>[m(a,{title:E.value.navbarTitle,"status-bar":"","background-color":"#ff3c36",color:"#fff","left-icon":"left","right-icon":"more",fixed:"",onClickLeft:c(p),onClickRight:c(f)},null,8,["title","onClickLeft","onClickRight"]),m(x,{title:e.$t("onlinePayment.text.scanCodeToPay"),type:"line"},{default:o((()=>[m(s,{class:"code-wrapper pb-30"},{default:o((()=>[m(n,{mode:"widthFix",onClick:t[0]||(t[0]=e=>{return t=B.value.qrcode_url,void _({urls:[t]});var t}),src:B.value.qrcode_url,style:{width:"500rpx"}},null,8,["src"]),m(s,{class:"font-16-red-bold mt-30"},{default:o((()=>[d(y(E.value.contentTitle),1)])),_:1}),m(s,{class:"instructions mt-30"},{default:o((()=>[m(s,null,{default:o((()=>[d(y(e.$t("onlinePayment.text.illustrate")),1)])),_:1}),m(s,{class:"instructions-content font-12"},{default:o((()=>[m(s,null,{default:o((()=>[d(y(e.$t("onlinePayment.text.tip2"))+y(B.value.max_money),1)])),_:1}),m(s,{class:"mt-10"},{default:o((()=>[d(y(e.$t("onlinePayment.text.tip3")),1)])),_:1}),m(s,{class:"mt-10"},{default:o((()=>[d(y(e.$t("onlinePayment.text.tip4")),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["title"]),m(s,{style:{height:"20rpx","background-color":"#eeeeee"}}),m(x,{class:"mt-20",title:e.$t("onlinePayment.text.tip5"),type:"line"},{default:o((()=>[m(q,{class:"p-30",model:I,rules:A,"label-position":"top","label-width":"100",ref_key:"formRef",ref:F},{default:o((()=>[m(k,{label:e.$t("onlinePayment.text.transferAmount"),prop:"money",required:""},{default:o((()=>[m(g,{type:"number",placeholder:A.money.message,"prefix-icon":"rmb",clearable:"",modelValue:I.money,"onUpdate:modelValue":t[1]||(t[1]=e=>I.money=e)},null,8,["placeholder","modelValue"])])),_:1},8,["label"]),m(k,{label:e.$t("onlinePayment.text.transferUser"),prop:"transfer_username",required:""},{default:o((()=>[m(g,{type:"text",placeholder:A.transfer_username.message,clearable:"",modelValue:I.transfer_username,"onUpdate:modelValue":t[2]||(t[2]=e=>I.transfer_username=e)},{prefix:o((()=>[m(V,{name:"account"})])),_:1},8,["placeholder","modelValue"])])),_:1},8,["label"])])),_:1},8,["model"]),m(s,{class:"mt-10 p-30"},{default:o((()=>[m(R,{color:"rgb(255, 69, 0)",text:e.$t("common.text.submit"),onClick:H},null,8,["text"])])),_:1}),m(s,{class:"p-30"},{default:o((()=>[m(s,{class:"font-16"},{default:o((()=>[d(y(e.$t("onlinePayment.text.tip6")),1)])),_:1}),m(s,{class:"u-flex font-14-grey mt-20"},{default:o((()=>[m(s,null,{default:o((()=>[d("1.")])),_:1}),m(s,{class:"ml-10"},{default:o((()=>[d(y(e.$t("onlinePayment.text.tip7")),1)])),_:1})])),_:1}),m(s,{class:"u-flex font-14-grey mt-10"},{default:o((()=>[m(s,null,{default:o((()=>[d("2.")])),_:1}),m(s,{class:"ml-10"},{default:o((()=>[d(y(e.$t("onlinePayment.text.tip8")),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["title"])])),_:1})}}},[["__scopeId","data-v-0c40556a"]]);export{R as default};
