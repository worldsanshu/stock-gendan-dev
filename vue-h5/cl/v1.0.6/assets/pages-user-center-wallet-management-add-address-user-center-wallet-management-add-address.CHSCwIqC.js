import{R as e,V as a,U as t,x as l,D as o,H as s,Y as n,z as r,F as i,v as d,cg as u,B as c,C as m,Z as p,y as f,G as b,b4 as g}from"./index-V1zTiwCe.js";import{_}from"./uni-nav-bar.B9quvnCD.js";import{r as k}from"./uni-app.es.CQrvLY-P.js";import{_ as v}from"./u-input.CiR-oGCa.js";import{_ as x,a as y}from"./u-form.6y5zeQu3.js";import{_ as h}from"./u-upload.D3oBH3s9.js";import{_ as w}from"./uni-section.B-Hdsl6J.js";import{_ as j}from"./u-button.B0l9ArWO.js";import{_ as V}from"./u-picker.CL7jm19O.js";import{d as T,k as C}from"./wallet.STqXUiio.js";import{_ as q}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.DZWFI7QG.js";import"./uni-status-bar.BjedvyN3.js";import"./u-icon.EexHLkhm.js";import"./u-line.BcX0DQci.js";import"./u-loading-icon.COOKVkTA.js";import"./u-popup.DhY3lYTv.js";import"./u-transition.BCj5qmVK.js";import"./u-status-bar.D4sFBUfg.js";const F=q(Object.assign({name:"user-center-wallet-management-add-address"},{__name:"user-center-wallet-management-add-address",setup(q){const{t:F}=e(),L=a(!1),$=a([[]]),A=a(),U=a([]),R=a([]),B=a([]),D=a([[]]),P=a(!1),G=a(!1),H=t({id:"",idText:"",alias:"",address:"",payment_code:"",bank_text:"",bank_code:"",bank_owner:"",bank_number:""}),I=a(""),S={idText:{type:"string",required:!0,message:"请选择钱包/币种",trigger:["blur","change"]},alias:{type:"string",required:!0,message:F("addAddress.text.tip2"),trigger:["blur","change"]},address:{type:"string",required:!0,message:F("addAddress.text.tip3"),trigger:["blur","change"]},bank_code:{type:"string",required:!0,message:"请选择开户银行",trigger:["blur","change"]},bank_owner:{type:"string",required:!0,message:"请输入开户姓名",trigger:["blur","change"]},bank_number:{type:"string",required:!0,message:"请输入卡号",trigger:["blur","change"]}};async function Y(){if("code"!==I.value||""!==H.address||""!==H.payment_code)if("address"!==I.value||""!==H.address)if("bank"!==I.value||""!==H.bank_number)try{await A.value.validate();const{error:e,message:a}=await C(H);await d({title:a,icon:e?"none":"success",duration:1e3}),e||setTimeout(p,1e3)}catch(e){e.length&&await d({title:e[0].message,icon:"none"})}else d({title:"请输入卡号!",icon:"none"});else d({title:"请输入收款地址!",icon:"none"});else d({title:"请输入收款地址或上传收款码!",icon:"none"})}async function Z(e){H.id=e.value[0].id,H.idText=e.value[0].name,I.value=e.value[0].WithdrawalTypeSelect,L.value=!1}function z(e){H.bank_text=e.value[0].name,H.bank_code=e.value[0].id,P.value=!1}return async function(){const{error:e,message:a,data:t}=await T({type:"wallet"});e?await d({title:a,icon:"none"}):$.value=[t.list]}(),async function(){const{error:e,message:a,data:t}=await u();e?await d({title:a,icon:"none"}):D.value=[t.bank]}(),(e,a)=>{const t=k(l("uni-nav-bar"),_),u=k(l("up-input"),v),T=k(l("up-form-item"),x),C=k(l("up-form"),y),q=k(l("up-upload"),h),E=c,J=k(l("uni-section"),w),N=k(l("up-button"),j),O=k(l("up-picker"),V);return m(),o(i,null,[s(t,{title:e.$t("page.title.addAddress"),border:!1,"status-bar":"","background-color":"#ff3c36",color:"#fff","left-icon":"left",fixed:"",onClickLeft:n(p)},null,8,["title","onClickLeft"]),s(E,{class:"body"},{default:r((()=>[s(C,{model:H,rules:S,"border-bottom":"",class:"form","label-width":"120",labelPosition:"top",ref_key:"formRef",ref:A},{default:r((()=>[s(T,{required:"",label:"钱包/币种",prop:"idText"},{default:r((()=>[s(u,{placeholder:S.idText.message,modelValue:H.idText,"onUpdate:modelValue":a[0]||(a[0]=e=>H.idText=e),type:"text","disabled-color":"#fff","placeholder-style":"color: '#333'","suffix-icon":"arrow-down",onClick:a[1]||(a[1]=e=>L.value=!0)},null,8,["placeholder","modelValue"])])),_:1}),"address"===I.value||"code"===I.value?(m(),f(T,{key:0,required:"",label:e.$t("addAddress.text.aliases"),prop:"alias"},{default:r((()=>[s(u,{placeholder:S.alias.message,modelValue:H.alias,"onUpdate:modelValue":a[2]||(a[2]=e=>H.alias=e),type:"text"},null,8,["placeholder","modelValue"])])),_:1},8,["label"])):b("",!0),"address"===I.value||"code"===I.value?(m(),f(T,{key:1,label:e.$t("addAddress.text.address"),required:"","label-width":"100%"},{default:r((()=>[s(u,{placeholder:S.address.message,modelValue:H.address,"onUpdate:modelValue":a[3]||(a[3]=e=>H.address=e),type:"text"},null,8,["placeholder","modelValue"])])),_:1},8,["label"])):b("",!0),"bank"===I.value?(m(),f(T,{key:2,required:"",label:e.$t("addBankCard.text.bankAccount"),prop:"bank_code"},{default:r((()=>[s(u,{type:"text",modelValue:H.bank_text,"onUpdate:modelValue":a[4]||(a[4]=e=>H.bank_text=e),placeholder:S.bank_code.message,"disabled-color":"#fff","placeholder-style":"color: '#333'","suffix-icon":"arrow-down",onClick:a[5]||(a[5]=e=>P.value=!0)},null,8,["modelValue","placeholder"])])),_:1},8,["label"])):b("",!0),"bank"===I.value?(m(),f(T,{key:3,required:"",label:"姓名",prop:"bank_owner"},{default:r((()=>[s(u,{placeholder:S.bank_owner.message,modelValue:H.bank_owner,"onUpdate:modelValue":a[6]||(a[6]=e=>H.bank_owner=e),type:"text"},null,8,["placeholder","modelValue"])])),_:1})):b("",!0),"bank"===I.value?(m(),f(T,{key:4,label:"卡号",required:"","label-width":"100%",prop:"bank_number"},{default:r((()=>[s(u,{placeholder:S.bank_number.message,modelValue:H.bank_number,"onUpdate:modelValue":a[7]||(a[7]=e=>H.bank_number=e),type:"text"},null,8,["placeholder","modelValue"])])),_:1})):b("",!0)])),_:1},8,["model"]),"code"===I.value?(m(),f(J,{key:0,title:"请上传收款码",type:"line",padding:"0 30rpx"},{default:r((()=>[s(E,{class:"passport-wrapper"},{default:r((()=>[s(q,{maxCount:1,fileList:U.value,onAfterRead:a[8]||(a[8]=e=>async function(e,a){const t="passportFileList"===a?U:"frontFileList"===a?R:B,l="passportFileList"===a?"passport_pic":"frontFileList"===a?"card_pic_hand":"card_pic_back";t.value=[{...e.file,status:"uploading",message:F("verified.text.uploading")}];const o=await g(e.file.url);H.payment_code=o.data.file_path,1===Number(o.status)?(t.value=[{...e.file,status:"success",message:F("verified.text.uploadSuccessFully")}],H.value[l]=o.data.file_path):await d({title:o.message||F("verified.text.uploadFailed"),icon:"none"})}(e,"passportFileList")),onDelete:a[9]||(a[9]=e=>(U.value=[],H.payment_code="")),class:"passport-content mt-50",name:"url"},null,8,["fileList"])])),_:1})])),_:1})):b("",!0),s(N,{text:e.$t("common.text.submit"),class:"mt-30",color:"rgb(255, 69, 0)",onClick:Y},null,8,["text"]),s(O,{ref:"uPickerRef",show:L.value,columns:$.value,cancelText:e.$t("common.text.cancel"),confirmText:e.$t("common.text.confirm"),onCancel:a[10]||(a[10]=e=>L.value=!1),onConfirm:Z,onClose:a[11]||(a[11]=e=>L.value=!1),"close-on-click-overlay":"","key-name":"name"},null,8,["show","columns","cancelText","confirmText"]),s(O,{show:P.value,loading:G.value,"close-on-click-overlay":"",ref:"uPickerRef","key-name":"name",columns:D.value,cancelText:e.$t("common.text.cancel"),confirmText:e.$t("common.text.confirm"),onCancel:a[12]||(a[12]=e=>P.value=!1),onConfirm:z,onClose:a[13]||(a[13]=e=>P.value=!1)},null,8,["show","loading","columns","cancelText","confirmText"])])),_:1})],64)}}}),[["__scopeId","data-v-e5b5da41"]]);export{F as default};
