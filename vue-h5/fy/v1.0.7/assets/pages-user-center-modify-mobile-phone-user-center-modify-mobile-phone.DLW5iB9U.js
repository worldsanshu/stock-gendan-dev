import{R as e,T as t,V as o,U as a,x as i,D as l,H as r,Y as s,z as n,F as u,B as m,C as c,Z as d,I as p,J as f,v as b,W as g,aw as _,X as v,a$ as w}from"./index-Sr5TDQAh.js";import{_ as x}from"./uni-nav-bar.By4fAi85.js";import{r as j}from"./uni-app.es.B63rG-5C.js";import{_ as h}from"./u-input.C3EplMLn.js";import{_ as y,a as C}from"./u-form.CW5ng56b.js";import{_ as k}from"./u-button.CU7Qcvp2.js";import{_ as V}from"./u-code.DYx93_fG.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.Dfj_jVd_.js";import"./uni-status-bar.vrssoW7T.js";import"./u-icon.CLEL_UCr.js";import"./u-line.CzSBNpvZ.js";import"./u-loading-icon.BJj1gzKk.js";const q=F(Object.assign({name:"user-center-profile-email"},{__name:"user-center-modify-mobile-phone",setup(F){const{t:q}=e(),R=t(),$=o(),B=a({mobile:"",captcha:""}),I=o(),U=o(),J=o(50),L={mobile:[{type:"string",required:!0,message:"请输入要修改的手机号",trigger:["blur"]},{validator:(e,t)=>uni.$u.test.mobile(t),message:"手机号不正确",trigger:["blur","change"]}],code:{type:"string",required:!0,message:q("mail.text.tip3"),trigger:["blur"]}};function T(){$.value.validateField("mobile",(async e=>{if(e.length)return void(await b({title:e[0].message,icon:"none"}));if(!I.value.canGetCode)return void(await b({title:q("mail.text.tip4"),icon:"none"}));await g({title:q("mail.text.tip5")});const{error:t,message:o}=await _({mobile:B.mobile,code:"86"});t?await b({title:o,icon:"none"}):(v(),t?await b({title:o,icon:"none"}):(await b({title:q("mail.text.tip6"),icon:"none"}),I.value.start()))}))}async function Z(){try{await $.value.validate();const{error:e,message:t}=await w(B);0===e?(await b({title:"修改成功，请重新登录!",icon:"none",duration:1500}),setTimeout((()=>{R.logout()}),1500)):await b({title:t,icon:"none"})}catch(e){e.length&&await b({title:e[0].message,icon:"none"})}}return(e,t)=>{const o=j(i("uni-nav-bar"),x),a=j(i("up-input"),h),b=j(i("up-form-item"),y),g=m,_=j(i("up-form"),C),v=j(i("up-button"),k),w=j(i("up-code"),V);return c(),l(u,null,[r(o,{title:"修改手机","status-bar":"","left-icon":"left","background-color":"#F8F8F8",fixed:"",border:!1,onClickLeft:s(d)},null,8,["onClickLeft"]),r(g,{class:"body"},{default:n((()=>[r(_,{class:"form","label-width":"120",labelPosition:"top",model:B,rules:L,ref_key:"formRef",ref:$},{default:n((()=>[r(b,{required:"","left-icon":"phone",label:"手机号",prop:"mobile",borderBottom:"",ref:"item1"},{default:n((()=>[r(a,{modelValue:B.mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>B.mobile=e),placeholder:"请输入要修改的手机号"},null,8,["modelValue"])])),_:1},512),r(b,{required:"","left-icon":"lock",label:e.$t("common.text.verificationCode"),prop:"code",borderBottom:"",ref:"item1"},{default:n((()=>[r(a,{type:"password",modelValue:B.code,"onUpdate:modelValue":t[1]||(t[1]=e=>B.code=e),placeholder:L.code.message},{suffix:n((()=>[r(g,{class:"font-12-blue",onClick:T},{default:n((()=>[p(f(U.value),1)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"]),r(v,{class:"mt-100",color:"rgb(255, 69, 0)",text:e.$t("common.text.submit"),onClick:Z},null,8,["text"]),r(w,{seconds:J.value,ref_key:"mobileCodeRef",ref:I,onChange:t[2]||(t[2]=e=>U.value=e)},null,8,["seconds"])])),_:1})],64)}}}),[["__scopeId","data-v-5a75ce95"]]);export{q as default};
