import{V as e,U as a,x as t,y as o,z as l,B as n,C as r,H as s,Y as i,Z as u,I as m,J as c,G as f,c7 as p,D as d,E as _,F as y,v as x,c5 as g,r as b,N as v,O as j}from"./index-eZLOZRr1.js";import{_ as h}from"./uni-nav-bar.D0OBKF7O.js";import{a as w,r as k}from"./uni-app.es.Cg_AhWrk.js";import{_ as V,a as C}from"./uni-list.CZYkGWDi.js";import{_ as I,a as B}from"./u-radio-group.B2kNDV0u.js";import{_ as U}from"./u-input.Bb_I8M-Y.js";import{_ as F,a as J}from"./u-form.1EFpheRJ.js";import{_ as L}from"./u-button.CF58NdxG.js";import{p as S}from"./wallet.DQcEX44v.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.DZmOUZ9v.js";import"./uni-status-bar.dIgvpYbO.js";import"./uni-badge.Ck9fiqKQ.js";import"./u-icon.Cinv0AqG.js";import"./u-line.Dqz3ABQq.js";import"./u-loading-icon.C9PbYIxd.js";const q=$({__name:"user-center-cbpay",props:{oItem:String},setup($){const q=e(),D=$;let E=a(JSON.parse(D.oItem)),H=null,N=null,O=e(0);E.extra&&(H=e(E.extra[0].value),N=a(E.extra),Y(E.extra[0].value));const R=a({money:"",payment_id:E.id,extra_value:H||null}),T={money:{type:"string",required:!0,message:"请输入有效的金额!",trigger:["blur","change"]}};async function Y(e){for(let a=0;a<=E.extra.length;a++)if(E.extra[a].value===e)return E.min_money=E.extra[a].min,E.max_money=E.extra[a].max,O.value=E.extra[a].multiple,!1}let Z=!1;async function z(){try{if(await q.value.validate(),R.money<parseFloat(E.min_money))return await x({title:`当前金额不能小于${E.min_money}！`,icon:"none"}),!1;if(R.money>parseFloat(E.max_money))return await x({title:`当前金额不能大于${E.max_money}！`,icon:"none"}),!1;if(E.extra&&R.money%O.value!=0)return await x({title:`请输入${O.value}的倍数金额！`,icon:"none"}),!1;const e=await S(R);if(e.error)return void(await x({title:e.message}));window.plus?plus.runtime.openURL(e.data.pay_url,(function(e){x({title:"打开外部浏览器出错: "+e.message,icon:"none"})})):g({title:"温馨提示",content:"即将跳转到第三方钱包支付",success:a=>{a.confirm&&(Z=!0,window.open(e.data.pay_url))}})}catch(e){e.length&&await x({title:e[0].message,icon:"none"})}}return w((()=>{Z&&(Z=!1,g({title:"付款确认",content:"完成付款后，点击「已完成付款」，查看订单支付状态。",confirmText:"已完成付款",cancelText:"更换支付",success:function(e){e.confirm?b({url:"/pages/user-center/user-center"}):e.cancel&&u()}}))})),(e,a)=>{const x=k(t("uni-nav-bar"),h),g=v,b=n,w=k(t("uni-list-item"),V),S=j,$=k(t("uni-list"),C),D=k(t("up-radio"),I),Z=k(t("up-radio-group"),B),G=k(t("up-input"),U),P=k(t("up-form-item"),F),Q=k(t("up-form"),J),A=k(t("up-button"),L);return r(),o(b,null,{default:l((()=>[s(x,{title:i(E).name,"status-bar":"","background-color":"#ff3c36",color:"#fff","left-icon":"left",fixed:"",onClickLeft:i(u)},null,8,["title","onClickLeft"]),i(E)?(r(),o(b,{key:0,class:"page-body"},{default:l((()=>[s(b,{class:"code mt-50"},{default:l((()=>[s(g,{src:i(E).logo_url,style:{width:"500rpx",height:"500rpx"}},null,8,["src"])])),_:1}),s($,{class:"mt-50"},{default:l((()=>[s(w,null,{header:l((()=>[s(b,{class:"font-14"},{default:l((()=>[m("最少充值金额：")])),_:1})])),body:l((()=>[s(b,{class:"font-12-grey u-flex-fill"},{default:l((()=>[m(c(i(E).min_money),1)])),_:1})])),_:1}),s(w,null,{header:l((()=>[s(b,{class:"font-14"},{default:l((()=>[m("最大充值金额：")])),_:1})])),body:l((()=>[s(b,{class:"font-12-grey u-flex-fill"},{default:l((()=>[m(c(i(E).max_money),1)])),_:1})])),_:1}),i(E).extra&&i(O)>1?(r(),o(w,{key:0},{header:l((()=>[s(b,{class:"font-14"},{default:l((()=>[m("充值金额为："),s(S,{style:{color:"#3c9cff"}},{default:l((()=>[m(c(i(O)),1)])),_:1}),m(" 的倍数")])),_:1})])),_:1})):f("",!0)])),_:1}),s(Q,{class:"form mt-50","label-width":"120",labelPosition:"top",model:R,rules:T,ref_key:"formRef",ref:q},{default:l((()=>[i(E).extra?(r(),o(Z,{key:0,modelValue:i(H),"onUpdate:modelValue":a[0]||(a[0]=e=>p(H)?H.value=e:H=e),class:"up-radio-group",onChange:Y},{default:l((()=>[(r(!0),d(y,null,_(i(N),((e,a)=>(r(),o(D,{customStyle:{marginBottom:"8px"},key:a,label:e.title,name:e.value,activeColor:"#19be6b",style:{"margin-right":"40rpx"}},null,8,["label","name"])))),128))])),_:1},8,["modelValue"])):f("",!0),s(P,{label:"充值金额",required:"",prop:"money",borderBottom:""},{default:l((()=>[s(G,{type:"number",modelValue:R.money,"onUpdate:modelValue":a[1]||(a[1]=e=>R.money=e),placeholder:"请输入充值金额"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),s(A,{class:"mt-50",color:"rgb(255, 69, 0)",text:"提交",onClick:z})])),_:1})):f("",!0)])),_:1})}}},[["__scopeId","data-v-c1d5dc12"]]);export{q as default};
