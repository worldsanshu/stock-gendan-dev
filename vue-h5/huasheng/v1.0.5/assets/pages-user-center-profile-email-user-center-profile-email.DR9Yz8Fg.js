import{R as e,T as a,V as t,U as i,x as o,D as l,H as r,Y as s,z as n,F as m,B as u,C as c,Z as d,I as p,J as f,q as g,W as b,ax as _,X as x,aT as v}from"./index-DugkB_-4.js";import{_ as w}from"./uni-nav-bar.DGUi_IvM.js";import{r as j}from"./uni-app.es.CX-CC-lz.js";import{_ as h}from"./u-input.UpaywbSH.js";import{_ as y,a as C}from"./u-form.MzjK-z7U.js";import{_ as k}from"./u-button.D_9ELcMi.js";import{_ as V}from"./u-code.zWmIK01X.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.D9BxN9k6.js";import"./uni-status-bar.D_XiF9iL.js";import"./u-icon.Ca1c56qc.js";import"./u-line.BpwwmqXn.js";import"./u-loading-icon.CCS9DSWM.js";const q=$(Object.assign({name:"user-center-profile-email"},{__name:"user-center-profile-email",setup($){const{t:q}=e(),F=a(),B=t(),U=i({email:F.userinfo.email,code:""}),I=t(),R=t(),D=t(50),H={email:[{type:"string",required:!0,message:q("mail.text.tip1"),trigger:["blur"]},{validator:(e,a)=>uni.$u.test.email(a),message:q("mail.text.tip2"),trigger:["blur","change"]}],code:{type:"string",required:!0,message:q("mail.text.tip3"),trigger:["blur"]}};function J(){B.value.validateField("email",(async e=>{if(e.length)return void(await g({title:e[0].message,icon:"none"}));if(!I.value.canGetCode)return void(await g({title:q("mail.text.tip4"),icon:"none"}));await b({title:q("mail.text.tip5")});const{error:a,message:t}=await _({email:U.email,captcha:"spew"});a?await g({title:t,icon:"none"}):(x(),a?await g({title:t,icon:"none"}):(await g({title:q("mail.text.tip6"),icon:"none"}),I.value.start()))}))}async function L(){try{await B.value.validate();const{error:e,message:a}=await v(U);await g({title:a,icon:"none",duration:1e3}),e||(await F.refreshUserinfo(),d())}catch(e){e.length&&await g({title:e[0].message,icon:"none"})}}return(e,a)=>{const t=j(o("uni-nav-bar"),w),i=j(o("up-input"),h),g=j(o("up-form-item"),y),b=u,_=j(o("up-form"),C),x=j(o("up-button"),k),v=j(o("up-code"),V);return c(),l(m,null,[r(t,{title:e.$t("page.title.mail"),"status-bar":"","left-icon":"left","background-color":"#F8F8F8",fixed:"",border:!1,onClickLeft:s(d)},null,8,["title","onClickLeft"]),r(b,{class:"body"},{default:n((()=>[r(_,{class:"form","label-width":"120",labelPosition:"top",model:U,rules:H,ref_key:"formRef",ref:B},{default:n((()=>[r(g,{required:"","left-icon":"email",label:e.$t("mail.text.yourMailbox"),prop:"email",borderBottom:"",ref:"item1"},{default:n((()=>[r(i,{modelValue:U.email,"onUpdate:modelValue":a[0]||(a[0]=e=>U.email=e),placeholder:H.email[0].message},null,8,["modelValue","placeholder"])])),_:1},8,["label"]),r(g,{required:"","left-icon":"lock",label:e.$t("common.text.verificationCode"),prop:"code",borderBottom:"",ref:"item1"},{default:n((()=>[r(i,{type:"password",modelValue:U.code,"onUpdate:modelValue":a[1]||(a[1]=e=>U.code=e),placeholder:H.code.message},{suffix:n((()=>[r(b,{class:"font-12-blue",onClick:J},{default:n((()=>[p(f(R.value),1)])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])])),_:1},8,["model"]),r(x,{class:"mt-100",color:"rgb(255, 69, 0)",text:e.$t("common.text.submit"),onClick:L},null,8,["text"]),r(v,{seconds:D.value,ref_key:"emailCodeRef",ref:I,onChange:a[2]||(a[2]=e=>R.value=e)},null,8,["seconds"])])),_:1})],64)}}}),[["__scopeId","data-v-6919b057"]]);export{q as default};
